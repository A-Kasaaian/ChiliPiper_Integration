<!-- Add the Following Code to the Parent Webpage in which the Pardot Embed HTML code resides -->
<script src="https://js.chilipiper.com/marketing.js" type="text/javascript"></script>
<script>
  var leadValues = {};
  var uri = decodeURIComponent(
    window.location.href.split("?").length > 1 ? window.location.href.split("?")[1].replace(/\+/g, " ") : ""
  );
  var urlParams = new URLSearchParams(uri);
  var entries = urlParams.entries();
  var valid = false;
  for (pair of entries) {
    if (pair[0].toLowerCase().includes("email") && pair[1].includes("@")) {
      valid = true;
    }
    leadValues[pair[0]] = pair[1];
  }
  if (valid && Object.keys(leadValues).length > 0) {
    ChiliPiper.submit(leadValues["CPTenantDomain"], leadValues["CPTenantRouter"], {
      map: true,
      lead: leadValues,
    });
    console.log(leadValues);
  }
</script>
