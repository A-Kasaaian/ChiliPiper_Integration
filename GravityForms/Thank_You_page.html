<script src="https://js.chilipiper.com/marketing.js" type="text/javascript"></script>
<script>
  const tenantDomain = "[[tenant_domain]]"; // replace
  const routerName = "[[router_name]]"; // replace
  var leadValues = {};
  var uri = decodeURIComponent(
    window.location.href.split("?").length > 1 ? window.location.href.split("?")[1].replace(/\+/g, " ") : ""
  );
  var urlParams = new URLSearchParams(uri);
  var entries = urlParams.entries();
  var valid = false;
  for (pair of entries) {
    leadValues[pair[0]] = pair[1];
    if (pair[0].toLowerCase().includes("email")) {
      leadValues[pair[0]] = pair[1].replaceAll(" ", "+"); // fix spaces for emails
      valid = true;
    }
  }
  if (valid) {
    ChiliPiper.submit(tenantDomain, routerName, {
      map: true,
      lead: leadValues,
    });
    console.log(leadValues);
  }
</script>
